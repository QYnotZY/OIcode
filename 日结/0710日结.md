# 0710 public

1.最大流、费用流算法(Dinic)

2.拆点：如果每个元素有限制，用两个点表示一个元素，入点连向出点的边容量即限制。

3.最大权闭合子图：建图，源点连正权点，容量为其贡献，负权点连汇点，容量为其代价，最后按原图连无穷容量的边。

4.对于单点连满足条件的后缀，可以拉几条链，每个元素对应链上一点。

5.对于连一个区间，可以建出线段树进行连边。

6.特殊题型：借用网络流思想推式子。

7.实现：如果第二次网络流的图是在第一次图的基础上加了几条边，可以直接加边并在残留网上跑。

## A : P3376 【模板】网络最大流

模版题。

Dinic：建边及反向边。先bfs求出dis数组，顺便判断源汇点连通性；再dfs多路增广即可，记得加当前弧和余量优化。

## B : P2766 最长不下降子序列问题

网络流24题。（独立：0）

**常见拆点思路：将一个元素拆成入点和出点，两点连边的容量是其可用个数，若元素A与B可以构成合法的A, B的形式，则从A的出点向B的入点连边即可**。

先暴力跑一遍DP，元素i可以接元素j的条件是：i < j && dp[i] + 1 == dp[j] && a[i] <= a[j]。元素使用次数题目中有。建图即可。

**优化：如果只是加了一些边再跑网络流，可以在残留网上加边，将上次的答案加上这次。**

## C : P2762 太空飞行计划问题

网络流24题。（独立：0.25）

**常见模型：二分图最大权闭合子图。**

此题可以先将所有实验的经费累加，答案即累加结果减去代价。建图时源点向实验连边，实验器材向汇点连边，最后和源点连通的即为选择的闭合子图。选择一个实验器材的代价为其费用，抛弃一个实验器材的代价为其经费。为了强制实验需要的器材，我们从实验向器材连无穷容量的边。

## D : ARC125E Snack

(独立：0)

**借用网络流思想的推式子题。**

该题暴力建出网络流模型：源点向零食连边（容量为A[i]），每个零食向孩子连边（容量为B[j]），孩子向汇点连边（容量为C[j]）。最大流就是答案。

但这题直接跑会超时。发现图很有规律，于是转而考虑答案如何表示。由于最小割等于最大流，故答案为：

$$\sum_{i \in S} A[i] + \sum_{i \in T} C[i] + \sum_{i \notin T} B[i] * (n - |S|)$$

$$= \sum_{i \in S} A[i] + \sum C[i] + \sum_{i \notin T} (B[i] * (n - |s|) - C[i])$$

设$x = |S|$，只要确定x，上式便容易求得最小值，只需提前按$A[i]$及$\frac{C[i]}{B[i]}$排序，即可求出前x小的$A[i]$，二分出所有小于0的$B[i]*(n - x) - C[i]$。枚举x，求出最小值即为答案。

## E : CF818G Four Melodies

(独立：0.5)

**常见优化建图：一个点连向一个满足条件的后缀集合，可以对条件拉一条链，将元素的出边向链上第一个符合条件的元素连边即可。**

每个点建出入点和出点，拉七条其上元素mod7相等的链，再拉几条其上元素都相等的链，入点连条件相符的，出点连条件顺承的。跑费用流。

## F : ARC107F Sum of Abs

(独立：0)

与最大权闭合子图有些相似。考虑每个点的贡献只可能为点权（下简称“正”）或点权相反数（“负”），可以建图如下：做最小割，与源点相连的点贡献为正，与汇点相连的点贡献为负，则正权点向源点连，负权点向汇点连，代价即为两倍的点权绝对值，每个点再拆成入点和出点，连一条边容量为a[i] + |b[i]|。注：点权指b[i]。

## G : 蜥蜴

(独立：0.25)

很经典的建图，每个柱子拆成入点和出点，连边为柱子的高度；源点连有蜥蜴的柱子，容量为1；能够跳到的柱子间连无穷容量边；能跳出去的柱子连汇点，容量为无穷。